
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>نموذج متعدد الموظفين</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #f5f5f5; padding: 30px; }
        .form-container { background: white; padding: 20px; border-radius: 8px; width: 100%; max-width: 750px; margin: auto; }
        label { margin-top: 10px; font-weight: bold; }
        input { display: block; width: 100%; padding: 8px; margin-bottom: 10px; }
        button { padding: 10px 20px; background: #007BFF; color: white; border: none; cursor: pointer; margin-right: 10px; }
        #passwordSection { margin-top: 20px; display: none; }
        #downloadSection { margin-top: 10px; display: none; }
        .employee-count { margin-top: 10px; font-weight: bold; }
    </style>
</head>
<body>
    <div class="form-container">
        <h2>نموذج إدخال معلومات متعددة</h2>

        <label>الاسم الثلاثي واللقب:</label>
        <input type="text" id="name">
        <label>العنوان الوظيفي:</label>
        <input type="text" id="title">
        <label>التحصيل الدراسي:</label>
        <input type="text" id="education">
        <label>سنة التخرج:</label>
        <input type="text" id="graduation">
        <label>تاريخ التعيين:</label>
        <input type="date" id="appointment">
        <label>جهة التعيين:</label>
        <input type="text" id="department">
        <label>مكان العمل الحالي:</label>
        <input type="text" id="workplace">
        <label>السكن:</label>
        <input type="text" id="address">
        <label>الحالة الزوجية:</label>
        <input type="text" id="marital">
        <label>رقم الهاتف:</label>
        <input type="text" id="phone">
        <label>البريد الإلكتروني:</label>
        <input type="email" id="email">

        <button onclick="addEmployee()">إضافة الموظف</button>
        <div class="employee-count" id="countDisplay">عدد الموظفين المدخلين: 0</div>

        <div id="passwordSection">
            <label>الرقم السري لتحميل الملف:</label>
            <input type="password" id="password">
            <button onclick="checkPassword()">تحقق</button>
        </div>

        <div id="downloadSection">
            <button onclick="downloadExcel()">تحميل جميع البيانات</button>
        </div>
    </div>

    <script>
        let employees = [];

        function addEmployee() {
            const entry = [
                document.getElementById("name").value,
                document.getElementById("title").value,
                document.getElementById("education").value,
                document.getElementById("graduation").value,
                document.getElementById("appointment").value,
                document.getElementById("department").value,
                document.getElementById("workplace").value,
                document.getElementById("address").value,
                document.getElementById("marital").value,
                document.getElementById("phone").value,
                document.getElementById("email").value
            ];
            employees.push(entry);
            document.getElementById("countDisplay").textContent = "عدد الموظفين المدخلين: " + employees.length;
            document.getElementById("passwordSection").style.display = "block";
            document.querySelectorAll("input").forEach(input => input.value = "");
        }

        function checkPassword() {
            const entered = document.getElementById("password").value;
            if (entered === "Am1234") {
                document.getElementById("downloadSection").style.display = "block";
            } else {
                alert("الرقم السري غير صحيح");
            }
        }

        function downloadExcel() {
            const headers = ["الاسم", "العنوان الوظيفي", "التحصيل الدراسي", "سنة التخرج", "تاريخ التعيين", "جهة التعيين", "مكان العمل", "السكن", "الحالة الزوجية", "الهاتف", "البريد الإلكتروني"];
            const data = [headers, ...employees];
            const ws = XLSX.utils.aoa_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "الموظفون");
            XLSX.writeFile(wb, "كل_الموظفين.xlsx");
        }
    </script>
</body>
</html>
