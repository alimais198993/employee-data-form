
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>نموذج معلومات الموظفين مع مرفقات</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.0/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #f5f5f5; padding: 30px; }
        .form-container { background: white; padding: 20px; border-radius: 8px; width: 100%; max-width: 700px; margin: auto; }
        label { margin-top: 10px; font-weight: bold; }
        input { display: block; width: 100%; padding: 8px; margin-bottom: 10px; }
        button { padding: 10px 20px; background: #4CAF50; color: white; border: none; cursor: pointer; }
    </style>
</head>
<body>
    <div class="form-container">
        <h2>استمارة معلومات الموظف</h2>

        <label>الاسم الثلاثي واللقب:</label>
        <input type="text" id="name">
        <label>العنوان الوظيفي:</label>
        <input type="text" id="title">
        <label>التحصيل الدراسي:</label>
        <input type="text" id="education">
        <label>سنة التخرج:</label>
        <input type="text" id="graduation">
        <label>تاريخ التعيين:</label>
        <input type="date" id="appointment">
        <label>جهة التعيين:</label>
        <input type="text" id="department">
        <label>مكان العمل الحالي:</label>
        <input type="text" id="workplace">
        <label>السكن:</label>
        <input type="text" id="address">
        <label>الحالة الزوجية:</label>
        <input type="text" id="marital">
        <label>رقم الهاتف:</label>
        <input type="text" id="phone">
        <label>البريد الإلكتروني:</label>
        <input type="email" id="email">

        <label>صورة البطاقة الوطنية:</label>
        <input type="file" id="idCard" accept="image/*">

        <label>صورة بطاقة السكن:</label>
        <input type="file" id="addressCard" accept="image/*">

        <button onclick="exportData()">تصدير البيانات والمرفقات</button>
    </div>

    <script>
        async function exportData() {
            const zip = new JSZip();
            const excelData = [
                ["الاسم", "العنوان الوظيفي", "التحصيل الدراسي", "سنة التخرج", "تاريخ التعيين", "جهة التعيين", "مكان العمل", "السكن", "الحالة الزوجية", "الهاتف", "البريد الإلكتروني"],
                [
                    document.getElementById("name").value,
                    document.getElementById("title").value,
                    document.getElementById("education").value,
                    document.getElementById("graduation").value,
                    document.getElementById("appointment").value,
                    document.getElementById("department").value,
                    document.getElementById("workplace").value,
                    document.getElementById("address").value,
                    document.getElementById("marital").value,
                    document.getElementById("phone").value,
                    document.getElementById("email").value
                ]
            ];

            const ws = XLSX.utils.aoa_to_sheet(excelData);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "معلومات الموظف");
            const excelBuffer = XLSX.write(wb, { bookType: 'xlsx', type: 'array' });
            zip.file("بيانات_الموظف.xlsx", excelBuffer);

            const idFile = document.getElementById("idCard").files[0];
            const addressFile = document.getElementById("addressCard").files[0];

            if (idFile) {
                zip.file("صورة_البطاقة.jpg", await idFile.arrayBuffer());
            }
            if (addressFile) {
                zip.file("صورة_السكن.jpg", await addressFile.arrayBuffer());
            }

            zip.generateAsync({ type: "blob" }).then(content => {
                saveAs(content, "معلومات_الموظف_كاملة.zip");
            });
        }
    </script>
</body>
</html>
